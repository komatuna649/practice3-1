<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>javascript</title>
    <meta name="description" content="site">
    <style>
        .collect {
            display: flex;
            list-style: none;
        }

        .list {
            display: flex;
            list-style: none;
        }

        .list li {
            width: 100px;
        }

        .border-color:hover {
            outline: solid 2px skyblue;
        }

        .add-list {
            list-style: none;
        }
    </style>
</head>

<body>
    <h1>ToDoリスト</h1>
    <ul class="collect">
        <li>
            <input id="all" type="radio" name="radio" value="1" checked>
            <label for="all">全て</label>
        </li>
        <li>
            <input id="work" type="radio" name="radio" value="2">
            <label for="work">作業中</label>
        </li>
        <li>
            <input id="complete" type="radio" name="radio" value="3">
            <label for="complete">完了</label>
        </li>
    </ul>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>コメント</th>
                <th>状態</th>
            </tr>
        </thead>
        <tbody id="add-list">

        </tbody>
    </table>
    <h2>新規タスクの追加</h2>
    <div>
        <input type="text" class="border-color " id="js-input" />
        <button id="btn">追加</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const button = document.getElementById('btn');
            const lists = [];
            const btnWork = document.createElement('button');

            button.addEventListener('click', function () {
                const jsInput = document.getElementById('js-input');
                const todo = { id: lists.length + 1, comment: jsInput.value };
                lists.push(todo);
                console.log(lists)
                clearList()
                createList()
            });

            function clearList() {
                const list = document.getElementById('add-list');
                while (list.firstChild) {
                    list.removeChild(list.firstChild);
                }
            }

            function createList() {
                lists.map((todo) => {
                    // console.log(lists)
                    createTodo(todo)
                })
            }
            function createTodo(todo) {
                console.log(todo)
                const addList = document.getElementById('add-list');
                const tableRecord = document.createElement('tr');
                const tableId = document.createElement('td');
                const jsInput = document.getElementById('js-input');
                const tableComment = document.createElement('td');
                const createButtonTd = document.createElement('td');
                const id = "td-" + todo.id;
                createButtonTd.id = id;
                tableId.textContent = todo.id;
                tableComment.textContent = todo.comment;
                jsInput.value = '';
                tableRecord.appendChild(tableId);
                tableRecord.appendChild(tableComment);
                addList.appendChild(tableRecord);
                tableRecord.appendChild(createButtonTd);
                btnWorkCreate(id);
                btnDeleteCreate(id, todo.id);
            }

            function btnWorkCreate(id) {
                const btnWork = document.createElement('button');
                btnWork.textContent = '作業中';
                const buttonTd = document.getElementById(id);
                buttonTd.appendChild(btnWork);
            };

            function btnDeleteCreate(id, index) {
                const btnDelete = document.createElement('button');
                btnDelete.textContent = '削除';
                const buttonTd = document.getElementById(id);
                btnDelete.dataset.id = index ;
                buttonTd.appendChild(btnDelete);
                btnDelete.onclick = function () {
                    console.log(this.dataset.id);
                    lists.splice(this.dataset.id, 1);
                    clearList();
                    createList();
                };
            };
        });
    </script>
</body>

</html>